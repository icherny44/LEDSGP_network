library(visNetwork)
library(data.table)
library(stringr)
# manually download .csv from Google docs and place in working directory
# in the future, automate download from G-docs
gsheet <- fread("LEDS GP Collaboration and Coordination.csv")
# use first 30 obs for testing
gsheet <- data.table(gsheet[1:51,])
#-------------------------------------------------------------------------------
# Create nodes
activities <- gsheet[,.(Activity,Country,Begin.Date,End.Date,Status)]
activities[,Type := "Activity"]
activities[,id := paste0("a",1:nrow(activities))]
setnames(activities,"Activity","Name")
# add leads and collaborators as nodes
collabs <- strsplit(gsheet[,Collaborators],split = ",")
wgs.rps <- c(gsheet[,Lead],unlist(collabs))
wgs.rps <- unlist(lapply(wgs.rps,str_trim))
wgs.rps <- unlist(lapply(wgs.rps,
function(x) str_replace_all(x,"[[:punct:]]","")))
wgs.rps <- wgs.rps[!grepl("All",wgs.rps)]
wgs.rps <- data.table(unique(wgs.rps))
Names <- fread("Names.csv")
gp.nodes <- merge(Names,wgs.rps,by="V1")
nodes <- rbind(activities,gp.nodes,
fill=TRUE)
setkey(nodes,id)
nodes[,typeID := .GRP,by=Type]
node.types <- unique(nodes[,Type])
num.types <- length(node.types)
#-------------------------------------------------------------------------------
# Create edges
edges <- melt(gsheet[,.(Activity,Lead)],id.vars=1)
collabs <- melt(strsplit(gsheet[,Collaborators],split = ","))
collabs$Activity <- gsheet[,Activity][collabs$L1]
collabs$variable <- "Collaborator"
edges <- rbind(edges,collabs[,-2],fill=TRUE)
edges <- merge(edges,nodes[,.(id,Name)],by.x="Activity",by.y="Name",
all.x=T,all.y=F)
edges <- merge(edges,nodes[,.(id,V1)],by.x="value",by.y="V1",
all.x=T,all.y=F)
#-------------------------------------------------------------------------------
# set up the nodes data.frame with node attributes
visnodes <- data.frame(id = nodes$id,
title = nodes$Name,
label = ifelse(nodes$Type == "Activity","",nodes$Name),
font = list(size = 14,
color = "black"),
group = nodes$Type,
size = ifelse(nodes$Type == "Activity",10,20),
shape = "dot",
color = c("green","tomato","purple","blue")[nodes$typeID])
# set up the edges data.frame with edge attributes
visedges <- data.frame(from = edges$id.x, to = edges$id.y,
width = 2,
smooth = TRUE)
visedges <- visedges[!is.na(visedges$to),]
# nodes for legend
lnodes <- data.frame(id = 1:num.types,
label = node.types,
shape = c( "dot"),
color = c("green","tomato","purple","blue")[1:num.types],
size = 10,
stringsAsFactors = F)
# plot the thing
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network
gsheet <- fread("LEDS GP Collaboration and Coordination.csv")
# use first 30 obs for testing
gsheet <- data.table(gsheet[1:52,])
#-------------------------------------------------------------------------------
# Create nodes
activities <- gsheet[,.(Activity,Country,Begin.Date,End.Date,Status)]
activities[,Type := "Activity"]
activities[,id := paste0("a",1:nrow(activities))]
setnames(activities,"Activity","Name")
# add leads and collaborators as nodes
collabs <- strsplit(gsheet[,Collaborators],split = ",")
wgs.rps <- c(gsheet[,Lead],unlist(collabs))
wgs.rps <- unlist(lapply(wgs.rps,str_trim))
wgs.rps <- unlist(lapply(wgs.rps,
function(x) str_replace_all(x,"[[:punct:]]","")))
wgs.rps <- wgs.rps[!grepl("All",wgs.rps)]
wgs.rps <- data.table(unique(wgs.rps))
Names <- fread("Names.csv")
gp.nodes <- merge(Names,wgs.rps,by="V1")
nodes <- rbind(activities,gp.nodes,
fill=TRUE)
setkey(nodes,id)
nodes[,typeID := .GRP,by=Type]
node.types <- unique(nodes[,Type])
num.types <- length(node.types)
#-------------------------------------------------------------------------------
# Create edges
edges <- melt(gsheet[,.(Activity,Lead)],id.vars=1)
collabs <- melt(strsplit(gsheet[,Collaborators],split = ","))
collabs$Activity <- gsheet[,Activity][collabs$L1]
collabs$variable <- "Collaborator"
edges <- rbind(edges,collabs[,-2],fill=TRUE)
edges <- merge(edges,nodes[,.(id,Name)],by.x="Activity",by.y="Name",
all.x=T,all.y=F)
edges <- merge(edges,nodes[,.(id,V1)],by.x="value",by.y="V1",
all.x=T,all.y=F)
#-------------------------------------------------------------------------------
# set up the nodes data.frame with node attributes
visnodes <- data.frame(id = nodes$id,
title = nodes$Name,
label = ifelse(nodes$Type == "Activity","",nodes$Name),
font = list(size = 14,
color = "black"),
group = nodes$Type,
size = ifelse(nodes$Type == "Activity",10,20),
shape = "dot",
color = c("green","tomato","purple","blue")[nodes$typeID])
# set up the edges data.frame with edge attributes
visedges <- data.frame(from = edges$id.x, to = edges$id.y,
width = 2,
smooth = TRUE)
visedges <- visedges[!is.na(visedges$to),]
# nodes for legend
lnodes <- data.frame(id = 1:num.types,
label = node.types,
shape = c( "dot"),
color = c("green","tomato","purple","blue")[1:num.types],
size = 10,
stringsAsFactors = F)
# plot the thing
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network
gsheet <- fread("LEDS GP Collaboration and Coordination.csv")
# use first 30 obs for testing
gsheet <- data.table(gsheet[1:53,])
#-------------------------------------------------------------------------------
# Create nodes
activities <- gsheet[,.(Activity,Country,Begin.Date,End.Date,Status)]
activities[,Type := "Activity"]
activities[,id := paste0("a",1:nrow(activities))]
setnames(activities,"Activity","Name")
# add leads and collaborators as nodes
collabs <- strsplit(gsheet[,Collaborators],split = ",")
wgs.rps <- c(gsheet[,Lead],unlist(collabs))
wgs.rps <- unlist(lapply(wgs.rps,str_trim))
wgs.rps <- unlist(lapply(wgs.rps,
function(x) str_replace_all(x,"[[:punct:]]","")))
wgs.rps <- wgs.rps[!grepl("All",wgs.rps)]
wgs.rps <- data.table(unique(wgs.rps))
Names <- fread("Names.csv")
gp.nodes <- merge(Names,wgs.rps,by="V1")
nodes <- rbind(activities,gp.nodes,
fill=TRUE)
setkey(nodes,id)
nodes[,typeID := .GRP,by=Type]
node.types <- unique(nodes[,Type])
num.types <- length(node.types)
#-------------------------------------------------------------------------------
# Create edges
edges <- melt(gsheet[,.(Activity,Lead)],id.vars=1)
collabs <- melt(strsplit(gsheet[,Collaborators],split = ","))
collabs$Activity <- gsheet[,Activity][collabs$L1]
collabs$variable <- "Collaborator"
edges <- rbind(edges,collabs[,-2],fill=TRUE)
edges <- merge(edges,nodes[,.(id,Name)],by.x="Activity",by.y="Name",
all.x=T,all.y=F)
edges <- merge(edges,nodes[,.(id,V1)],by.x="value",by.y="V1",
all.x=T,all.y=F)
#-------------------------------------------------------------------------------
# set up the nodes data.frame with node attributes
visnodes <- data.frame(id = nodes$id,
title = nodes$Name,
label = ifelse(nodes$Type == "Activity","",nodes$Name),
font = list(size = 14,
color = "black"),
group = nodes$Type,
size = ifelse(nodes$Type == "Activity",10,20),
shape = "dot",
color = c("green","tomato","purple","blue")[nodes$typeID])
# set up the edges data.frame with edge attributes
visedges <- data.frame(from = edges$id.x, to = edges$id.y,
width = 2,
smooth = TRUE)
visedges <- visedges[!is.na(visedges$to),]
# nodes for legend
lnodes <- data.frame(id = 1:num.types,
label = node.types,
shape = c( "dot"),
color = c("green","tomato","purple","blue")[1:num.types],
size = 10,
stringsAsFactors = F)
# plot the thing
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network
gsheet <- fread("LEDS GP Collaboration and Coordination.csv")
gsheet <- data.table(gsheet[1:52,])
View(gsheet)
gsheet <- fread("LEDS GP Collaboration and Coordination.csv")
gsheet <- data.table(gsheet[1:53,])
View(gsheet)
gsheet <- fread("LEDS GP Collaboration and Coordination.csv")
# use first 30 obs for testing
gsheet <- data.table(gsheet[1:52,])
#-------------------------------------------------------------------------------
# Create nodes
activities <- gsheet[,.(Activity,Country,Begin.Date,End.Date,Status)]
activities[,Type := "Activity"]
activities[,id := paste0("a",1:nrow(activities))]
setnames(activities,"Activity","Name")
# add leads and collaborators as nodes
collabs <- strsplit(gsheet[,Collaborators],split = ",")
wgs.rps <- c(gsheet[,Lead],unlist(collabs))
wgs.rps <- unlist(lapply(wgs.rps,str_trim))
wgs.rps <- unlist(lapply(wgs.rps,
function(x) str_replace_all(x,"[[:punct:]]","")))
wgs.rps <- wgs.rps[!grepl("All",wgs.rps)]
wgs.rps <- data.table(unique(wgs.rps))
Names <- fread("Names.csv")
gp.nodes <- merge(Names,wgs.rps,by="V1")
nodes <- rbind(activities,gp.nodes,
fill=TRUE)
setkey(nodes,id)
nodes[,typeID := .GRP,by=Type]
node.types <- unique(nodes[,Type])
num.types <- length(node.types)
#-------------------------------------------------------------------------------
# Create edges
edges <- melt(gsheet[,.(Activity,Lead)],id.vars=1)
collabs <- melt(strsplit(gsheet[,Collaborators],split = ","))
collabs$Activity <- gsheet[,Activity][collabs$L1]
collabs$variable <- "Collaborator"
edges <- rbind(edges,collabs[,-2],fill=TRUE)
edges <- merge(edges,nodes[,.(id,Name)],by.x="Activity",by.y="Name",
all.x=T,all.y=F)
edges <- merge(edges,nodes[,.(id,V1)],by.x="value",by.y="V1",
all.x=T,all.y=F)
#-------------------------------------------------------------------------------
# set up the nodes data.frame with node attributes
visnodes <- data.frame(id = nodes$id,
title = nodes$Name,
label = ifelse(nodes$Type == "Activity","",nodes$Name),
font = list(size = 14,
color = "black"),
group = nodes$Type,
size = ifelse(nodes$Type == "Activity",10,20),
shape = "dot",
color = c("green","tomato","purple","blue")[nodes$typeID])
# set up the edges data.frame with edge attributes
visedges <- data.frame(from = edges$id.x, to = edges$id.y,
width = 2,
smooth = TRUE)
visedges <- visedges[!is.na(visedges$to),]
# nodes for legend
lnodes <- data.frame(id = 1:num.types,
label = node.types,
shape = c( "dot"),
color = c("green","tomato","purple","blue")[1:num.types],
size = 10,
stringsAsFactors = F)
# plot the thing
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network
View(gsheet)
View(edges)
collabs <- melt(strsplit(gsheet[,Collaborators],split = ","))
View(collabs)
collabs
collabs[2]
collabs[1]
collabs[[1]]
levels(as.factor(collabs[1]))
levels(as.factor(collabs[[1]))
levels(as.factor(collabs[[1]]))
collabs <- melt(strsplit(gsheet[,Collaborators],split = ","))
collabs[1] <- unlist(lapply(collabs[1],str_trim))
View(collabs)
levels(as.factor(collabs[[1]]))
gsheet <- fread("LEDS GP Collaboration and Coordination.csv")
# use first 30 obs for testing
gsheet <- data.table(gsheet[1:52,])
#-------------------------------------------------------------------------------
# Create nodes
activities <- gsheet[,.(Activity,Country,Begin.Date,End.Date,Status)]
activities[,Type := "Activity"]
activities[,id := paste0("a",1:nrow(activities))]
setnames(activities,"Activity","Name")
# add leads and collaborators as nodes
collabs <- strsplit(gsheet[,Collaborators],split = ",")
wgs.rps <- c(gsheet[,Lead],unlist(collabs))
wgs.rps <- unlist(lapply(wgs.rps,str_trim))
wgs.rps <- unlist(lapply(wgs.rps,
function(x) str_replace_all(x,"[[:punct:]]","")))
wgs.rps <- wgs.rps[!grepl("All",wgs.rps)]
wgs.rps <- data.table(unique(wgs.rps))
Names <- fread("Names.csv")
gp.nodes <- merge(Names,wgs.rps,by="V1")
nodes <- rbind(activities,gp.nodes,
fill=TRUE)
setkey(nodes,id)
nodes[,typeID := .GRP,by=Type]
node.types <- unique(nodes[,Type])
num.types <- length(node.types)
#-------------------------------------------------------------------------------
# Create edges
edges <- melt(gsheet[,.(Activity,Lead)],id.vars=1)
collabs <- melt(strsplit(gsheet[,Collaborators],split = ","))
collabs[1] <- unlist(lapply(collabs[1],str_trim))
collabs$Activity <- gsheet[,Activity][collabs$L1]
collabs$variable <- "Collaborator"
edges <- rbind(edges,collabs[,-2],fill=TRUE)
edges <- merge(edges,nodes[,.(id,Name)],by.x="Activity",by.y="Name",
all.x=T,all.y=F)
edges <- merge(edges,nodes[,.(id,V1)],by.x="value",by.y="V1",
all.x=T,all.y=F)
#-------------------------------------------------------------------------------
# set up the nodes data.frame with node attributes
visnodes <- data.frame(id = nodes$id,
title = nodes$Name,
label = ifelse(nodes$Type == "Activity","",nodes$Name),
font = list(size = 14,
color = "black"),
group = nodes$Type,
size = ifelse(nodes$Type == "Activity",10,20),
shape = "dot",
color = c("green","tomato","purple","blue")[nodes$typeID])
# set up the edges data.frame with edge attributes
visedges <- data.frame(from = edges$id.x, to = edges$id.y,
width = 2,
smooth = TRUE)
visedges <- visedges[!is.na(visedges$to),]
# nodes for legend
lnodes <- data.frame(id = 1:num.types,
label = node.types,
shape = c( "dot"),
color = c("green","tomato","purple","blue")[1:num.types],
size = 10,
stringsAsFactors = F)
# plot the thing
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visPhysics(barnesHut.gravitationalConstant = "-1000")
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visPhysics(barnesHut.gravitationalConstant = "-1000") %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
?visPhysics
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visPhysics(gravitationalConstant = "-1000") %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visPhysics(barnesHut = list(gravitationalConstant = "-1000")) %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visPhysics(barnesHut = list(gravitationalConstant = "-500")) %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visPhysics(barnesHut = list(gravitationalConstant = "-5000")) %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network
LEDS_GP_network <- visNetwork(visnodes,visedges,width = "100%",heigh="1000px",
main = "LEDS GP Activities") %>%
visPhysics(barnesHut = list(gravitationalConstant = "-8000")) %>%
visInteraction(tooltipDelay = 0) %>%
visOptions(selectedBy = list(variable = "group",
#  selected = "Country",
style = 'width: 200px; height: 26px;
background: #f8f8f8;
color: black;
border: none;
outline: none;'),
highlightNearest = TRUE) %>%
visLegend(addNodes = lnodes,
useGroups = F,
width = .21)
LEDS_GP_network
